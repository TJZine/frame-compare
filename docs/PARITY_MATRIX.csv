Feature,Legacy Location/Ref,Modern Module,Parity (Yes/Partial/No),Notes / Gaps,Suggested Fix/Owner/Size(S/M/L)
Runtime RAM limit,"legacy/compv4_improved.py L20-L25","frame_compare.py / src/vs_core.py",Yes,"`set_ram_limit` mirrors legacy max_cache_size before opening clips.","Keep; add smoke test ensuring limit is applied (Core, S)"
Trim overrides,"legacy/compv4_improved.py L94-L112","frame_compare.py / src/vs_core.py",Yes,"Per-file trim_start applied via override maps when building plans.","Maintain with unit coverage (Core, S)"
Trim end overrides,"legacy/compv4_improved.py L113-L134","frame_compare.py / src/vs_core.py",Yes,"Negative and positive trim_end respected during clip slicing.","Maintain; add regression tests (Core, S)"
FPS override pairs,"legacy/compv4_improved.py L135-L162","frame_compare.py / src/vs_core.py",Yes,"Explicit fps_map applied when override provides [num, den].","Add test verifying AssumeFPS invocation (Core, S)"
"change_fps 'set' reference","legacy/compv4_improved.py L149-L162","frame_compare.py",Yes,"Reference clip marked and propagated to other plans when `set` is used.","Document behaviour; add scenario test (Core, S)"
Frame data caching toggle,"legacy/compv4_improved.py L34-L37","src/analysis.py / frame_compare.py",Yes,"JSON cache written/read when `save_frames_data` true and config matches.","Add hot/cold integration test (Analysis, M)"
Frame data filename,"legacy/compv4_improved.py L144-L156","frame_compare.py / src/analysis.py",Yes,"Cache stored at `frame_data_filename` under input dir like legacy text file.","None"
Analyze clip selection,"legacy/compv4_improved.py L168-L210","frame_compare.py",Yes,"CLI matches by index/name/release group to pick analysis source.","Add CLI test covering label/index selection (CLI, M)"
Downscale height,"legacy/compv4_improved.py L640-L676","src/analysis.py",Yes,"Analysis clip optionally resized when taller than threshold.","Property-based test around even-dimension rounding (Analysis, S)"
Analysis step,"legacy/compv4_improved.py L688-L716","src/analysis.py",Yes,"Indices sampled every N frames via range step.","None"
Analyze in SDR,"legacy/compv4_improved.py L650-L676","src/analysis.py / src/vs_core.py",Yes,"Tonemapping invoked before stats when flag enabled.","Add HDR fixture test (Analysis, M)"
Use quantiles,"legacy/compv4_improved.py L780-L789","src/analysis.py",Yes,"Dark/bright thresholds computed from quantiles when enabled.","Add regression vs fixed-band fallback (Analysis, S)"
Screen separation (seconds),"legacy/compv4_improved.py L587-L606","src/analysis.py",Yes,"Quarter-gap motion heuristic restored alongside deterministic caching.","Maintain; consider exposing divisor in config (Analysis, S)"
Motion diff radius,"legacy/compv4_improved.py L796-L824","src/analysis.py",Yes,"Smoothing window size honoured via `_smooth_motion`.","Add smoothing edge-case test (Analysis, S)"
Random/user frames,"legacy/compv4_improved.py L1600-L1610","src/analysis.py",Yes,"User frames inserted first; RNG seeded for deterministic random picks.","Maintain"
Screenshot directory name,"legacy/compv4_improved.py L147-L154","frame_compare.py / src/screenshot.py",Yes,"Output directory created under configured folder name.","Integration test verifying cleanup when auto-upload deletes (CLI, M)"
Add frame info overlay,"legacy/compv4_improved.py L1758-L1796","src/screenshot.py",Yes,"Writer annotates frames when enabled, matching legacy overlay intent.","Add golden comparison once Pillow available (Screenshots, M)"
FFmpeg writer toggle,"legacy/compv4_improved.py L44-L47","src/screenshot.py",Yes,"Trim-aware frame indices keep FFmpeg and VapourSynth outputs aligned, with logged fallbacks for unexpected errors.","Add integration tests for negative trim padding (Screenshots, M)"
Upscale smaller clips,"legacy/compv4_improved.py L1704-L1776","src/screenshot.py",Yes,"Global geometry plan now aligns all clips to the tallest cropped height when `upscale=true`.","Maintain; add property-based tests for extreme aspect ratios (Screenshots, M)"
Single resolution override,"legacy/compv4_improved.py L1704-L1776","src/screenshot.py",Yes,"Setting `single_res` forces target height with optional downscale respecting `upscale` flag.","Add test locking scaling math (Screenshots, S)"
Modulus crop,"legacy/compv4_improved.py L1680-L1703","src/screenshot.py",Yes,"Mod crop planner mirrors legacy even-dimension trimming with letterbox awareness.","Maintain"
Letterbox/pillarbox awareness,"legacy/compv4_improved.py L1680-L1703","src/screenshot.py",Yes,"Cropping adjusts dominant axis to avoid stripping letterbox bars.","Add fixture-based test for portrait/landscape (Screenshots, S)"
Naming preference `always_full_filename`,"legacy/compv4_improved.py L48-L60","frame_compare.py / src/utils.py",Yes,"Duplicate labels gain version or index suffixes, keeping abbreviated names stable by default.","Maintain; extend tests for mixed GuessIt/Anitopy inputs (CLI, S)"
Naming parser preference,"legacy/compv4_improved.py L48-L60","src/utils.py / frame_compare.py",Yes,"CLI forwards `prefer_guessit` flag and falls back to Anitopy like legacy.","Add unit test toggling GuessIt availability (Utils, S)"
Slow.pics auto upload,"legacy/compv4_improved.py L1872-L1971","frame_compare.py / src/slowpics.py",Yes,"Auto-upload flow completes via REST API with shortcut + optional browser open.","Add integration test with mocked requests (Slowpics, M)"
Slow.pics remove-after days,"legacy/compv4_improved.py L72-L86","src/slowpics.py",Yes,"Removal window passed as numeric payload matching legacy behaviour.","None"
Slow.pics webhook,"legacy/compv4_improved.py L1972-L1980","src/slowpics.py",Yes,"Webhook registration plus direct POST (with retries) mirrors legacy delivery semantics.","Monitor for configurable retry/backoff tuning (Slowpics, M)"
Slow.pics delete screen dir,"legacy/compv4_improved.py L1992-L1999","frame_compare.py",Yes,"Directory removed after successful upload when flag true, matching legacy clean-up.","Maintain"
CLI --input override,"legacy/compv4_improved.py usage section","frame_compare.py",Yes,"Command-line input directory overrides config just like manual folder placement.","Add CLI regression test (CLI, S)"
Clipboard copy of slow.pics URL,"legacy/compv4_improved.py L1962-L1971","frame_compare.py",Yes,"Optional pyperclip copy attempted with graceful failure handling.","Document dependency, add mock test (CLI, S)"
